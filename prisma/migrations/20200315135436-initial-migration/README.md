# Migration `20200315135436-initial-migration`

This migration has been generated by Kim Fransman at 3/15/2020, 1:54:36 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "EventStatus" AS ENUM ('STARTED', 'FINISHED');

CREATE TYPE "EventType" AS ENUM ('INDIVIDUAL', 'TEAM');

CREATE TYPE "EventScoring" AS ENUM ('POINTS', 'STROKES');

CREATE TYPE "SeasonStatus" AS ENUM ('REGULAR', 'FINALS', 'FINISHED');

CREATE TABLE "public"."Course" (
    "club" text  NOT NULL DEFAULT '',
    "id" SERIAL,
    "name" text  NOT NULL DEFAULT '',
    "par" integer  NOT NULL DEFAULT 72,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Event" (
    "course" integer  NOT NULL ,
    "id" SERIAL,
    "scoring" "EventScoring" NOT NULL DEFAULT 'POINTS',
    "season" integer  NOT NULL ,
    "special" boolean  NOT NULL DEFAULT false,
    "status" "EventStatus" NOT NULL DEFAULT 'STARTED',
    "type" "EventType" NOT NULL DEFAULT 'INDIVIDUAL',
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Hole" (
    "course" integer  NOT NULL ,
    "id" SERIAL,
    "index" integer  NOT NULL DEFAULT 0,
    "number" integer  NOT NULL DEFAULT 0,
    "par" integer  NOT NULL DEFAULT 0,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Player" (
    "firstName" text  NOT NULL DEFAULT '',
    "id" SERIAL,
    "lastName" text  NOT NULL DEFAULT '',
    "photo" text   ,
    "scoringSession" integer   ,
    "team" integer   ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Score" (
    "beers" Decimal(65,30)  NOT NULL DEFAULT 0,
    "event" integer  NOT NULL ,
    "eventPoints" Decimal(65,30)  NOT NULL DEFAULT 0,
    "id" SERIAL,
    "kr" integer  NOT NULL DEFAULT 0,
    "player" integer  NOT NULL ,
    "resultValue" Decimal(65,30)  NOT NULL DEFAULT 0,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Season" (
    "finalInfo" integer   ,
    "id" SERIAL,
    "name" text  NOT NULL DEFAULT '',
    "status" "SeasonStatus" NOT NULL DEFAULT 'REGULAR',
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."FinalInfo" (
    "id" SERIAL,
    "photo" text  NOT NULL DEFAULT '',
    "story" text  NOT NULL DEFAULT '',
    "winner" integer  NOT NULL ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Team" (
    "id" SERIAL,
    "scoringSession" integer   ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."ScoringSession" (
    "currentHole" integer  NOT NULL DEFAULT 1,
    "event" integer  NOT NULL ,
    "id" SERIAL,
    PRIMARY KEY ("id")
) 

CREATE UNIQUE INDEX "Season.name" ON "public"."Season"("name")

ALTER TABLE "public"."Event" ADD FOREIGN KEY ("course")REFERENCES "public"."Course"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Event" ADD FOREIGN KEY ("season")REFERENCES "public"."Season"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Hole" ADD FOREIGN KEY ("course")REFERENCES "public"."Course"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Player" ADD FOREIGN KEY ("team")REFERENCES "public"."Team"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."Player" ADD FOREIGN KEY ("scoringSession")REFERENCES "public"."ScoringSession"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."Score" ADD FOREIGN KEY ("event")REFERENCES "public"."Event"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Score" ADD FOREIGN KEY ("player")REFERENCES "public"."Player"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Season" ADD FOREIGN KEY ("finalInfo")REFERENCES "public"."FinalInfo"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."FinalInfo" ADD FOREIGN KEY ("winner")REFERENCES "public"."Player"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Team" ADD FOREIGN KEY ("scoringSession")REFERENCES "public"."ScoringSession"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."ScoringSession" ADD FOREIGN KEY ("event")REFERENCES "public"."Event"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200315135436-initial-migration
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,100 @@
+generator client {
+  provider      = "prisma-client-js"
+  binaryTargets = ["native"]
+}
+
+datasource db {
+  provider = "postgresql"
+  url      = env("DATABASE_URL")
+}
+
+model Course {
+  id     Int     @id @default(autoincrement())
+  club   String
+  name   String
+  par    Int     @default(72)
+  events Event[]
+  holes  Hole[]
+}
+
+model Event {
+  id      Int          @id @default(autoincrement())
+  special Boolean      @default(false)
+  scoring EventScoring @default(POINTS)
+  status  EventStatus  @default(STARTED)
+  type    EventType    @default(INDIVIDUAL)
+  course  Course
+  season  Season
+  scores  Score[]
+}
+
+model Hole {
+  id     Int    @id @default(autoincrement())
+  index  Int
+  number Int
+  par    Int
+  course Course
+}
+
+model Player {
+  id        Int     @id @default(autoincrement())
+  firstName String
+  lastName  String
+  photo     String?
+  scores    Score[]
+}
+
+model Score {
+  id          Int    @id @default(autoincrement())
+  resultValue Float
+  eventPoints Float
+  event       Event
+  player      Player
+  beers       Float  @default(0)
+  kr          Int    @default(0)
+}
+
+model Season {
+  id        Int          @id @default(autoincrement())
+  name      String       @unique
+  status    SeasonStatus
+  events    Event[]
+  finalInfo FinalInfo?
+}
+
+model FinalInfo {
+  id     Int    @id @default(autoincrement())
+  photo  String
+  winner Player
+  story  String
+}
+
+model Team {
+  id      Int      @id @default(autoincrement())
+  players Player[]
+}
+
+model ScoringSession {
+  id          Int      @id @default(autoincrement())
+  event       Event
+  currentHole Int      @default(value: 1)
+  player      Player[]
+  teams       Team[]
+}
+
+
+enum EventStatus {
+  STARTED FINISHED
+}
+
+enum EventType {
+  INDIVIDUAL TEAM
+}
+
+enum EventScoring {
+  POINTS STROKES
+}
+
+enum SeasonStatus {
+  REGULAR FINALS FINISHED
+}
```


